Utilisation de Bind 9.

## Installation

``` bash
# Modifier le nom
nano /etc/hostname
# Modifier le domaine
domainname nitou.lan
```

``` bash
# Installation
apt install bind9
# Installation de la doc
apt install bind9-doc
# Désinstallation
apt autoremove bind9 --purge
```

Chaque serveur maitre + esclave sera aussi en serveur cache, soit hybride. Pas en furtif. 
Maitre cache récursif
Slave cache récursif

## Fichiers de configuration

### named.conf
Fichier principale de bind, il contient surtout les définitions des zones par défaut et fait référence aux autres fichiers de configuration. 

`nano /etc/bind/named.conf`

![[Pasted image 20230109150311.png]]

### named.conf.local
Vide au départ, il contiendra la définition de vos zones

`nano /etc/bind/named.conf.local`

Pour le maître : 
![[Pasted image 20230109152531.png]]
Pour le slave : 
![[Pasted image 20230109162125.png]]

Je définis que mon serveur est maitre ou slave, ainsi que le fichier qui définit la zone. 

### named.conf.options
Contient les options supplémentaires de bind tel que les redirecteurs ou encore des options concernant la sécurité.
![[Pasted image 20230109153640.png]]
#### forwarders
Avec « forwarders » nous définissons les Redirecteurs de notre DNS.
Cet élément est optionnel, deux configuration sont possibles   :
-   Sans : en commentant ce paragraphe nous indiquons que notre serveur DNS résoudra toute les adresses en utilisant son cache et les serveurs DNS racines.

    Cette méthode est considéré comme la façon d'avoir les informations les plus sûre mais aussi celle qui augmente le plus le trafic du serveur DNS ainsi que ca charge de travail.

-   Avec : en laissant ce paragraphe nous indiquons que notre serveur DNS se servira de son cache ou d'autres serveurs (récursif) pour résoudre les adresses pour lesquels notre serveur n'est pas Maître. Nous pouvons y mettre les serveurs DNS de Google Public DNS ou d'OpenDNS ou bien les serveurs DNS proposé par notre FAI.
   
    Il n'est pas recommandé d'utiliser les Serveurs DNS public car il ne sont pas considéré comme Fiable.
   
Pour notre serveur nous utiliserons les serveurs DNS récursifs de notre FAI pour alléger le trafic et la charge de nos serveurs DNS et pour bénéficier de la rapidité qu'offre le cache DNS du serveur récursif de notre FAI.

#### listen-on-v6
Avec « listen-on-v6 » nous définissons qui a le droit d'utiliser notre Serveur DNS.
Cette commande peux prendre les arguments suivants :
-   any : pour autoriser l'accès à tout le monde, y compris l'extérieur.
-   ip : pour autoriser l'accès a certaines IPs.
- Notation CIDR d'un réseau : pour autoriser l'accès a certain réseaux.

Pour notre serveur nous restreindrons l'utilisation à nos seuls réseau internes.

### rndc.key
défini la clé RNDC du serveur, souvent utilisé pour filtrer l'accès au serveur. 

#### zones.rfc1918 et db.empty
Ne doivent être ni supprimés ni modifiés.
Ils correspondant aux définitions de réseaux privés de classes A, B et C. Obligatoire pour respecter une norme RFC1918.

#### db.root
contient les définitions des serveurs DNS racines et est situé dans usr/share/dns.
A réactualiser avec le site de l'internic (root hints)

#### db.0 et db.255
contiennent respectivement la zone directe et la zone inverse de localhost.

#### db.nitou.lan et db.168.192
Contiennent la zone directe et la zone inverse du DNS local.

en zone directe : 
![[Pasted image 20230109155235.png]]
![[Pasted image 20230109155258.png]]

en zone inverse : 
![[Pasted image 20230109155949.png]]
![[Pasted image 20230109160007.png]]
