
https://www.it-connect.fr/cours/dhcp-du-protocole-a-la-configuration/

1. Que signifie l’acronyme DHCP ?
= Dynamic Host Configuration Protocol
https://fr.wikipedia.org/wiki/Dynamic_Host_Configuration_Protocol

2. De quel protocole vient il ?
Il vient du protocole bootstrap.

3. Quel RFC définit en premier ce protocole ?
Le protocole a été présenté pour la première fois en 10.1993 et est défini par la [RFC 1531](https://www.rfc-editor.org/rfc/rfc1531)
Il a été modifié et complété par les RFC :  [RFC 1534](https://www.rfc-editor.org/rfc/rfc1534), [RFC 2131](https://www.rfc-editor.org/rfc/rfc2131) et [RFC 2132](https://www.rfc-editor.org/rfc/rfc2132)

4. A quel numéro de port est-il lié ?
port serveur = 67
port client = 68

Pour afficher les ports liés à chaque service, on peut l'afficher dans le fichier système suivant : C:\Windows\System32\drivers\etc

5. Est ce qu’il travaille en TCP ou en UDP ?
UDP (pour sa rapidité)

6. Qu’est ce qu’un LEASE ?
= bail
Lorsqu'un client demande au [[Serveur DHCP]] une adresse IP, le serveur fournit une adresse IP et ses paramètres de configuration pour une période donnée, appelée bail ou lease. 

7. Combien y a-t-il de secondes dans une heure, une journée, une semaine ?
1h = 3600s
1 journée = 86400s
1 semaine = 604800s

8. Qu’est ce qu’un bail statique ?
Si je souhaite qu'un appareil ai toujours la même adresse IP via le DHCP, je lui crée un bail statique.
On peut effectuer des réservations d’adresses en limitant la possibilité d’octroi de cette adresse au client possédant une adresse physique ou un « client identifié » donné. Ceci peut s’avérer utile pour des machines dont l’adresse doit rester fixe mais dont on veut contrôler de manière centrale et automatique les autres paramètres IP. Ce mécanisme est assuré par l’option 61 du [RFC 2131](https://www.rfc-editor.org/rfc/rfc2131)

Une autre option permet de donner toujours la même adresse IP à un équipement connecté à un port donné. Option 82 de la [RFC 30466](https://www.rfc-editor.org/rfc/rfc3046) 

9. Qu’est ce que du multi-pool ?
Le service DHCP nécessite un pool d'adresses IP. Un pool est une plage d'adresses IP au sein d'un SCOP. Il regroupe les adresses qui seront distribuées, ainsi que leurs options. 
Dans le cadre d'un réseau avec plusieurs VLAN, on met en place un multi-pool DHCP qui permet d'avoir une plage d'adresses et des options différentes pour chaque pool. 

10. Qu’est ce qu’une whitelist en MAC filtering ?
MAC filtering ou le filtrage d'adresses MAC est une méthode de contrôle d'accès au réseau, basé sur l'adresse MAC de la carte connectée au réseau. Ce filtrage permet de contrôler l'accès aux équipements réseaux via une whitelist notamment.
https://fr.wikipedia.org/wiki/Filtrage_par_adresse_MAC

11. Le DHCP traverse-t-il les routeurs ?
Non, certains routeurs acceptent la fonctionnalité relais DHCP et il faut donc l'installer pour que cela soit possible. S'ils n'acceptent pas cette fonctionnalité, il est nécessaire de l'installer sur un serveur dédié. 

12. Qu’est-ce-qu'un DHCP relais ?
[[Routeur]] ou serveur qui relaie les paquets DHCP au niveau du DHCP serveur. Il est utilisé dans le cas où le DHCP serveur n'est pas dans le même réseau que la machine client. 

13. Quels sont les trois modes d’allocations d’une adresse?
- allocation manuelle : le serveur propose une adresse IP spécifique que vous pouvez attribuer à un client.
- allocation automatique ou permanente : le serveur propose une adresse IP navec le même fonctionnement que l'adresse dynamique mais le serveur garde une table avec l'adresse IP préféré de cet équipement et la réassigne en priorité.
- allocation dynamique : le serveur propose une adresse IP au client pour une durée précise. Le serveur peut réclamer et réallouer l'adresse IP si elle n'est pas utilisée. Pour vérifier si une adresse IP est utilisable, le [[Serveur DHCP]] fait un ping.

14. DHCP supporte-t-il IPv6 ?
Oui, on l'appelle le protocole DHCPv6.

15. Quelle est la première information poussée par le serveur ?
L'adresse IP

16. La seconde ?
Le netmask

17. La troisième ?
La gateway

18. La quatrième ?
Le DNS

19. Donner quelques options poussées par le serveur ?
- serveur de temps
- bail
- configurations DHCP spécifiques à un groupe
- surveillance DHCP
- déconnexion automatique DHCP
- configuration supplémentaire pour les clients 
- détection de l'iveness DHCP
- échange de messages sécurisés
- groupe de serveurs DHCP actifs
- ...

20. Qu’est-ce-qu’un SCOPE ?
définit le masque de sous-réseaux du [[Serveur DHCP]]

21. Quand est-il intéressant d’avoir des baux courts ?
C'est intéressant sur des réseaux assez important, où les machines se connectent et se déconnectent fréquemment. En effet, si aucune adresse n'était libérée, au bout d'un certain temps aucune requête DHCP ne pourraient être satisfaites. 

22. Qu’est ce que l’adresse 255.255.255.255 en lien avec le DHCP ?
La machine client émet un broadcast (255.255.255.255) sur le réseau local. Lorsque le [[Serveur DHCP]] reçoit le paquet, il renvoie un autre paquet broadcast concernant toutes les informations requises pour le client.

23. Décrivez le processus d’attribution d’une adresse DHCP ?
![[requete.png]]

La première requête émise par le client est un message DHCPDISCOVER. Le serveur répond par un DHCPOFFER, en particulier pour soumettre une adresse IP au client. Le client établit sa configuration, demande éventuellement d'autres paramètres, puis fait un DHCPREQUEST pour valider son adresse IP. Le serveur répond simplement par un DHCPACK avec l'adresse IP pour confirmation de l'attribution. Normalement, c'est suffisant pour qu'un client obtienne une configuration réseau efficace, mais cela peut être plus ou moins long selon que le client accepte ou non l'adresse IP ou demande des infos complémentaires.

![[dhcp_new.gif]]

www.misfu.com/cours-fonctionnement-dhcp.html#6_-_Les_requêtes_et_les_messages_DHCP

24. Capturer des paquets DHCP à l’aide d’un outil de capture, effectuer une analyse.
``` bash
ipconfig /release
ipconfig /renew
```

![[Pasted image 20230110142413.png]]

25. Qu’est ce que l’ISC ?
= Internet System Consortiums
https://www.isc.org/dhcp/

26. Quel produit est développé par cet organisme en lien avec ce protocole ?
ISC qui est une solution opensource pour l'implémentation de serveurs DHCP, d'agents relais et de clients. Il est en fin de vie à partir de 2022 et est remplacé par KEA.

27. Trouvez un tutoriel en ligne sur l’installation du produit
Pour ISC : https://www.youtube.com/watch?v=bnKHfXo-iKo
Pour KEA : https://www.youtube.com/watch?v=QXgveZn4klM

28. Qu’est ce qu’une rogue DHCP ?
Un rogue DHCP est un [[Serveur DHCP]] pirate. 
![[DHCPRogue1.png]]

29. Qu’est ce que le 802.1x?
Standard lié à la sécurité des réseaux informatiques qui permet de contrôler l'accès aux équipements d'infrastructures réseaux, et par ce biais de relayer les informations liées aux dispositifs d'identification. 

30. Le DHCP est il conseillé dans des infrastructures type TPE ?
Oui

31. Le DHCP est il conseillé dans des grosses infrastructures ?
Oui

32. Expliquez ZEROCONF ?
C'est l'appellation générique d'un ensemble de protocoles permettant de créer automatiquement un réseau IP utilisable sans configuration particulière ou serveurs dédiés. 
https://fr.wikipedia.org/wiki/Zeroconf

33. Donnez la plage d’adressage de l’APIPA.
169.254.0.0/16, soit 169.254.0.0 à 169.254.255.255

34. Expliquer le DHCP snooping ?
Ce sont plusieurs techniques qui permettent d'améliorer la sécurité d'une infrastructure DHCP. 
Le DHCP snooping peut être configurés sur des LAN pour exclure les serveurs rogue DHCP et le trafic DHCP déformé. 