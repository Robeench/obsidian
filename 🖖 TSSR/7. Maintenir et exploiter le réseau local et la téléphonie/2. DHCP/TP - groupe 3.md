Louis, Romain, B√©n√©dicte, Cristian, Mickael

# Consignes
Routeur CISCO > prise salle
test en IP publique fixe, ai-je du r√©seau ? 
Puis branchement du PFSense
pr√©ciser au PFSense, pas de VLAN
Masque /24
faire un sch√©ma propre du r√©seau

Switch 1 - Cisco 2960G

VLAN 10 SRV
192.168.10.0/20
- WINSRV2022_DHCP
- WINSRV2022_DNS

VLAN 20 CLI
192.168.20.0/24
- Win 10 ou 11
cr√©ation d'une identit√© visuelle et d'un logo, et donc du nom de domaine.

VLAN 30 HOTSPOT
192.168.30.0/24
- AP wifi
- poste client

VLAN 40 VOIP
192.168.40.0/24
- serveur xivo
- PC client Zoiper
- ip phone

# Mise en place

![[DIAGRAMME.jpg]]

## Test de la connexion internet
Connexion d'un poste fixe √† la prise RJ45 en direct. 
Je d√©finis mon adresse IP en fixe pour permettre une sortie sur le WAN : 
IP fixe : 46.247.250.51
Netmask : 255.255.255.248
Gateway : 46.247.250.54
DNS : 1.1.1.1

## Test de configuration du switch
Installation de Putty

üìÇ Gestionnaire de p√©riph√©riques > Ports COM et LPT > USB Serial Port COM 3
Puis dans Putty, 
üìÇ Session > Serial > Serial Line COM3 > Open

``` bash
en
conf t
```

## Configuration du PF Sense
### Pr√©configuration du PF Sense
re0 = WAN
re1 = LAN1

- option = 1
- vlan = no
- r√©ponse = a
- branchement RJ45 / mur
- branchement RJ45 / switch
- r√©ponse = re1
- r√©ponse = yes
- enter an option = 2
- interface = 1
- r√©ponse = n
- enter address ip = 46.247.250.51
- subnet = 29
- gateway = 46.247.250.54
- ipv6 = n
- enter
- y
- y
- enter
- option = 7
- 1.1.1.1

## Configuration du switch
connexion via Putty
``` bash
#Cr√©ation des VLAN
en
conf t
vlan 10
name SRV
ex
vlan 20
name CLI
ex
vlan 30
name HOT
ex
vlan 40
name VOIP
ex
ex
show vlan
```

![[Pasted image 20230112142351.png]]

```
# Configuration des ports du switch
int range g0/1-6
switchport access vlan 10
ex
int range g0/7-12
switchport access vlan 20
ex
int range g0/13-18
switchport access vlan 30
ex
int range g0/19-24
switchport access vlan 40
ex
ex
show vlan
wr
```

![[Pasted image 20230112142423.png]]

Dans l'interface du PF Sense
üìÇ firewall > rules > LAN
r√®gle √† mettre en place pour les GTW_VLANxxx, avec any/any/any pour permettre dans un premier temps le ping.

``` bash
en 
conf t
int g0/44
switchport mode trunk
```

![[Pasted image 20230112142540.png]]

### Interface de PFSense
Connexion √† l'interface de PF Sense : 192.168.0.254

Modifier le hostname : routeur
Modifier le domaine : super.lan
primary DNS server : 1.1.1.1
secondary dns server : rien
time server hostname : ntp.unice.fr
timezone : Europe/Paris
configuration WAN : √† ne pas modifier, je l'ai d√©j√† configur√© pr√©c√©demment
configuration LAN : 192.168.0.254
netmask : 24
admin password : root

üìÇ services > dhcp relay
cocher enable dhcp relay
![[CONFIGURATION - PFSENSE - DHCP RELAY.jpg]]
destination server : adresse IP DHCP server

üìÇ interfaces > interface assignements
üìÇ interface > vlan > edit
parent = re1
vlan tag = 10
description = serveurs
√† refaire pour chaque vlan
sous-menu interface assignements
add 4 interfaces
![[CONFIGURATION - PFSENSE - FIREWALLS LAN.jpg]]
static IPv4 configuration
pas de passerelle
√† renommer "GTW_VLAN10_SRV"
√† faire pour les interfaces de chaque vlan
![[CONFIGURATION - PFSENSE - INTERFACES LAN.jpg]]
![[CONFIGURATION - PFSENSE - INTERFACES ASSIGNEMENTS.jpg]]
![[CONFIGURATION - PFSENSE - INTERFACES GTW VLAN 10.jpg]]
![[CONFIGURATION - PFSENSE - INTERFACES GTW VLAN 20.jpg]]
![[CONFIGURATION - PFSENSE - INTERFACES GTW VLAN 30.jpg]]
![[CONFIGURATION - PFSENSE - INTERFACES GTW VLAN 40.jpg]]


üìÇ Firewall > Rules > Floating > Edit
![[CONFIGURATION - PFSENSE - FIREWALLS FLOATING.jpg]]
![[CONFIGURATION - PFSENSE - FIREWALLS GTW VLAN 10.jpg]]
![[CONFIGURATION - PFSENSE - FIREWALLS GTW VLAN 20.jpg]]
![[CONFIGURATION - PFSENSE - FIREWALLS GTW VLAN 30.jpg]]
![[CONFIGURATION - PFSENSE - FIREWALLS GTW VLAN 40.jpg]]


## Montage des diff√©rentes machines
### DHCP
192.168.10.253

#### Configuration de la VLAN 40 
![[CONFIGURATION - SERVER-DHCP - CONFIGURATION VLAN40-1.jpg]]
![[CONFIGURATION - SERVER-DHCP - CONFIGURATION VLAN40.jpg]]

#### Configuration de la VLAN 30
![[CONFIGURATION - SERVER-DHCP - CONFIGURATION VLAN30-1.jpg]]
![[CONFIGURATION - SERVER-DHCP - CONFIGURATION VLAN30.jpg]]

#### Configuration de la VLAN 20
![[CONFIGURATION - SERVER-DHCP - CONFIGURATION VLAN20-1.jpg]]
![[CONFIGURATION - SERVER-DHCP - CONFIGURATION VLAN20.jpg]]

#### Configuration de la VLAN 10
![[CONFIGURATION - SERVER-DHCP - CONFIGURATION VLAN10-1.jpg]]
![[CONFIGURATION - SERVER-DHCP - CONFIGURATION VLAN10.jpg]]

### DNS
192.168.10.252

![[capture1.png]]
![[capture2.png]]

### Xivo
192.168.40.253

#### Configuration
![[CONFIGURATION - XIVO.jpg]]

#### Mod√®le de terminaison
![[CONFIGURATION - XIVO - RESEAU - MODELE TERMINAISON.jpg]]

#### Mod√®le de ligne
![[CONFIGURATION - XIVO - RESEAU - MODELE LIGNE.jpg]]

#### Interface
![[CONFIGURATION - XIVO - RESEAU - INTERFACE.jpg]]

#### DNS
![[CONFIGURATION - XIVO - RESEAU - DNS.jpg]]

#### DHCP
![[CONFIGURATION - XIVO - RESEAU - DHCP.jpg]]

#### IPBX - Utilisateur
![[CONFIGURATION - XIVO - IPBX - UTILISATEUR.jpg]]

#### IPBX - Ligne
![[CONFIGURATION - XIVO - IPBX - LIGNE.jpg]]
### Zoiper
T√©l√©charger et installer Zoiper
Appel au 101 : ok
![[Pasted image 20230113095447.png]]

### Machines clients
en DHCP

### WIFI
J'acc√®de √† l'interface en ligne via son adresse IP.
Je lui d√©finis son adresse IP : 192.168.30.253
J'enl√®ve la fonction DHCP.
Puis, je lui donne le r√¥le d'Access Point.
![[Pasted image 20230113091810.png]]
![[Pasted image 20230113091854.png]]









